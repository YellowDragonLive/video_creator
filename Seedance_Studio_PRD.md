# Seedance Studio 视频制作工具 — 需求文档 (PRD)

## 1. 项目概述

### 1.1 背景
Seedance Studio 是一款专为高效视频创作设计的本地 Web 应用程序。它深度集成了 Seedance 2.0 视频生成 API，并引入了 Gemini AI 辅助创作能力。

### 1.2 核心目标
- **标准化 Prompt 创作**：采用"导演五要素法"驱动提示词生成。
- **智能化资产管理**：支持手动上传与 AI 自动生成素材。
- **即时 API 适配**：一键导出与 Seedance API 兼容的 JSON 载荷。

---

## 2. 技术架构

### 2.1 核心技术栈
- **后端 (Backend)**: Python Flask (轻量级、响应快)。
- **前端 (Frontend)**: 原生 HTML5, CSS3, JavaScript (零框架依赖，极致加载速度)。
- **AI 能力 (AI Integration)**: Gemini 3.0 Flash (Prompt 逻辑生成) + Gemini 3.0 Pro(图像生成)。
- **资产处理 (Asset Processing)**: Pillow (图片缩略图)、FFmpeg (视频首帧提取)。
- **日志系统 (Logging Service)**: 基于 Python `logging` 的全栈日志持久化与异常追踪。

### 2.2 数据存储
- **本地存储**: 采用 JSON 文件持久化 Prompt 项目与素材元数据。
- **文件系统**: 素材文件保存在 `data/assets/`，缩略图保存在 `data/thumbnails/`。

---

## 3. 功能需求

### 3.1 Prompt 编辑器 (核心模块)
- **五要素导演法**: 拆分为角色 (Subject)、场景 (Scene)、动作 (Action)、运镜 (Camera)、氛围 (Atmosphere) 五个维度输入。
- **实时合成预览**: 自动将各要素组合为符合 Seedance 最佳实践的中文提示词。
- **参数控制面板**:
    - 任务类型：文生视频、图生视频、视频编辑、视频延长。
    - 模型选择：Seedance 2.0 (默认)、1.5 Pro 等。
    - 视频规格：分辨率 (480p/720p)、宽高比 (16:9/9:16/1:1等)、时长 (2-12秒)。
- **模板系统**: 预置常用风格模板，支持一键填充与二次编辑。
- **项目管理**: 支持 Prompt 的保存、加载与删除。

### 3.2 素材管理 (资产中心)
- **多渠道导入**: 
    - 支持图片、视频、音频的拖拽及点击上传。
    - 支持通过 AI 交互生成参考图片并直接存入素材库。
- **智能索引**:
    - 自动生成缩略图预览。
    - 支持标签 (Tag) 系统，方便分类管理。
    - 提供关键词全局搜索功能。
- **引用机制**: 素材可被 Prompt 项目引用，并能根据任务类型（如 `image2video`）自动映射为 API 中的 `image_url`。

### 3.3 Gemini AI 辅助能力
- **✨ AI 智能生成**: 根据用户一句简单的创意，AI 自动扩充为标准的五要素结构化 Prompt。
- **🎨 AI 素材创作**: 基于描述文字，生成高质量的参考图片，作为视频生成的起始帧或基础资产。

---

## 4. API 与规范

### 4.1 Seedance API 适配
系统输出的 JSON 严格遵循以下结构：
```json
{
  "model": "doubao-seedance-2-0-260128",
  "content": [
    { "type": "text", "text": "组合后的提示词内容" },
    { "type": "image_url", "image_url": { "url": "..." }, "image_role": "reference_image" }
  ],
  "video_config": {
    "resolution": "720p",
    "duration": 5,
    "ratio": "16:9",
    "fps": 24
  }
}
```

---

## 5. 日志与运维规范

### 5.1 日志存储
- **日志路径**: `data/logs/app.log`。
- **管理策略**: 
    - 采用 `RotatingFileHandler` 滚存。
    - 单个日志限额 5MB，保留最新 5 个版本。
- **日志级别**: 
    - `INFO`: 系统启动、API 请求、项目保存/删除、素材导入。
    - `ERROR`: API 解析异常、模型生成失败、全局未捕获异常（含堆栈）。

### 5.2 监控辅助
- 后端具备全局异常截断能力，防止崩溃扩散。
- 关键业务流程（如 AI 联调）具备全生命周期耗时及请求记录。

---

## 6. UI/UX 设计规范

- **界面风格**: 暗黑主题 (Dark Theme) + 玻璃拟态 (Glassmorphism)。
- **色彩体系**: 
    - 强调色：`#646cff` (主题蓝)、`#f39c12` (AI 特效金)。
    - 背景色：`#0a0a0f` (深邃黑)。
- **交互反馈**: 全局消息通知 (Toast)、上传进度实时显示、AI 生成状态动态。

---

## 6. 未来演进
- [ ] 接入 Seedance 实际生成接口，实现在线视频预览。
- [ ] 增加视频历史记录管理。
- [ ] 支持 AI 对已有视频进行分析并反推 Prompt。
